我们提出了一种快速车道检测算法，运行速度为50帧/秒，可以处理不同数量的车道并应对车道变化
传统车道线检测技术：依靠高度专业化的手工特征标记和启发式识别来识别车道线。这种手工标记的方法主要是基于颜色的特征，结构张量，条形过滤器，脊线特征等，然后用霍夫变换检测直线，卡尔曼滤波过滤；这些传统方法很容易由于道路场景变化而导致鲁棒性问题。

本文设计了一个多任务的网络，首先是一个分割网络，分出lane和背景，然后在此基础上用一个embedding branch对分割出的lane进行实例区分，最终实现对车道的实例分割。然后用曲线拟合的方式，拟合一条曲线。在鸟瞰图上进行，对于透视变换，不是采用固定的值，而是又训练了一个网络，输入图像，输出对应的透视变换矩阵。（透视变换也不一定非得是将输入图片转到鸟瞰图，意义是经过透视变换后，可以通过多项式曲线拟合来拟合lane的参数）

具体的方法：
嵌入分支（Embedding branch）：主要用于车道线的实例分割，如图所示，该网络解码得到的输出图中每一个像素对应一个N维的向量，在该N维嵌入空间中同一车道线的像素距离更接近，而不同车道线的像素的向量距离较大，从而区分像素属于哪一条车道线，该分支使用基于one-shot的方法做距离度量学习。

分割分支（Segmentation branch）：主要用于获取车道像素的分割结果（得到一个二分图，即筛选出车道线像素和非车道线像素），得到一个二分图像，如上图所示。为了训练一个这样的分割网络，原论文使用了tuSample数据集，在数据集中，车道线可能被其他车辆阻挡，在这种情况下，将车道线的标注(Ground truth)贯穿障碍物，如下图所示，从而使得分割网络在车道线被其他障碍物阻挡的情况下，依然可以完整检测出完整的车道线像素。分割网络使用标准的交叉熵损失函数进行训练，对于这个逐像素分类任务而言（车道线像素/非车道线像素分类），由于两个类别的像素极度不均衡，为了处理此问题，作者使用了bounded inverse class weighting方法（详见论文）。
 
嵌入分支的loss函数是两个距离度量的函数，意义就是让类内间距变小，类间间距变大；采用instance embedding的思路：
像素嵌入：再通过使用一个判别式损失函数来训练网络，网络的优化目标是将图像每个像素投影到 n维特征空间后，同属于一个实例的像素尽量靠近，形成一个 cluster, 每一个实例对应一个 cluster, 不同 cluster则尽量远离
Instance Embedding: Segmentation Without Proposals

网络采用的ENet，然后两个branch共享ENet的前两个阶段参数，第三个阶段的参数不共享。
总结起来就是用ENet进行语义分割出所有的车道线，然后再通过聚类的branch进行实例分割，区分出不同的车道线；
